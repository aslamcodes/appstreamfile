platform: "windows"
installers:
  - executable: "powershell"
    installScript: |
      Write-Host "Hello World"

  - executable: "powershell"
    installScript: |
      echo "Setting up environment"

catalog:
  - name: "Notepad"
    path: "C:\\Windows\\System32\\notepad.exe"
    display_name: "Notepad"
    parameters: ""
    icon_path: ""
    working_dir: ""

registry_config:
  - path: "HKEY_LOCAL_MACHINE\\Software\\MyApp"
    values:
      LogLevel: "DEBUG"
      EnableFeatureX: 1

  - path: "HKEY_CURRENT_USER\\Software\\ExampleApp\\UI"
    values:
      Theme: "Dark"
      FontSize: 14

files:
  - path: "C:\\AppStream\\Scripts\\Start-System.ps1"
    content: |
      Write-EventLog -LogName Application -Source AppStream -EventID 100 -Message "System session start"

  - path: "C:\\AppStream\\Scripts\\Start-User.ps1"
    content: |
      Write-Host "User profile initialization"

  - path: "C:\\AppStream\\Scripts\\End-System.ps1"
    content: |
      Write-EventLog -LogName Application -Source AppStream -EventID 200 -Message "System cleanup"

  - path: "C:\\AppStream\\Scripts\\End-User.ps1"
    content: |
      Write-Host "User session cleanup"

session_scripts:
  session_start:
    executables:
      - context: "system"
        filename: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
        arguments: "-Init -File C:\\AppStream\\Scripts\\Start-System.ps1"
        s3LogEnabled: true

      - context: "user"
        filename: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
        arguments: "-UserSetup -File C:\\AppStream\\Scripts\\Start-User.ps1"
        s3LogEnabled: true
    waitingTime: 60

  session_termination:
    executables:
      - context: "system"
        filename: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
        arguments: "-Init -File C:\\AppStream\\Scripts\\Start-System.ps1"
        s3LogEnabled: true

      - context: "user"
        filename: "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe"
        arguments: "-UserSetup -File C:\\AppStream\\Scripts\\Start-User.ps1"
        s3LogEnabled: true

    waitingTime: 60

image:
  name: "example_image"
  display_name: "example image"
  description: "example image"
  enable_dynamic_app_catalog: true
  use_latest_agent_version: false
  tags:
    - team:infra
    - env:dev
  dry_run: false
